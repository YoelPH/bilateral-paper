---
title: "Probabilistic Model of Bilateral Lymphatic Spread in Head and Neck Cancer"
authors:
  - name: Roman Ludwig
    orcid: 0000-0001-9434-328X
    email: roman.ludwig@usz.ch
  - name: Yoel Perez Haas
    email: yoel.perezhaas@usz.ch
  - name: Jan Unkelbach
    orcid: 0000-0002-4275-990X
    email: jan.unkelbach@usz.ch
format:
  html:
    code-fold: true
jupyter: python3
execute: 
  cache: true
---

# Introduction

- head and neck cancer spreads lymphatically
- may sometimes spread to contralateral side
- spreads more frequently and to larger extent contralaterally when tumor extends the mid-sagittal line
- we describe a model based on previously published hidden Markov model
- we extend it to cover the contralateral side, too
- ipsi- and contralateral side are correlated via time of diagnosis, which is correlated with T-category
- tumor extension over mid-sagittal line is modelled as random variable
- spread probabilities from tumor to contralateral LNLs in case of midline extesnion are linear combinations of these probabilities in case of ipsilateral spread and contralateral spread when tumor is clearly lateralized


# Methods


# Results

```{python}
from emcee import backends
from corner import corner
import matplotlib.pyplot as plt
from tueplots import figsizes, fontsizes

backend = backends.HDFBackend(
  filename="models/midline_fix.hdf5",
  read_only=True,
)
samples = backend.get_chain(thin=20)
ndim = samples.shape[-1]

plt.rcParams.update(**figsizes.icml2022_full(nrows=ndim))

fig, axes = plt.subplots(nrows=ndim, sharex=True)
for i, ax in enumerate(axes):
  ax.plot(samples[:,::10,i], color="gray", alpha=0.2)
  ax.axhline(samples[200:,:,i].mean(), color="red")
  ax.set_xlim(0., samples.shape[0])
  ax.set_ylim(0., 1.)
```
